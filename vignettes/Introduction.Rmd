---
title: "Introduction"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# ggalign
This package extends ggplot2 and provides numerous benefits for organizing and
arranging plots. It is specifically designed to align a specific axis of
multiple ggplot objects in a consistent order. This functionality is
particularly useful for plots that require manipulation of data order. A common
plot combination that can be effectively organized using this package includes a
dendrogram and a heatmap.

```{r setup}
library(ggalign)
```

Let's begin by creating some example data

```{r setup_data}
set.seed(123)
small_mat <- matrix(rnorm(81), nrow = 9)
rownames(small_mat) <- paste0("row", seq_len(nrow(small_mat)))
colnames(small_mat) <- paste0("column", seq_len(ncol(small_mat)))
```

`ggalign` provids two layouts to build plots:

  - `layout_heatmap`: the heatmap layout, annotation can be put in "top", "left",
  "bottom" and "right". See `vignette("layout-heatmap")` for more details.
  - `layout_stack`: align plots vertically or horizontally (You can also add
  layout_heatmap). See `vignette("layout-stack")` for more details (not
  completed).

## `Examples`

```{r}
expr <- readRDS(system.file(package = "ComplexHeatmap", "extdata", "gene_expression.rds"))
mat <- as.matrix(expr[, grep("cell", colnames(expr))])
base_mean <- rowMeans(mat)
mat_scaled <- t(apply(mat, 1, scale))

type <- gsub("s\\d+_", "", colnames(mat))

ggstack(data = mat_scaled) +
  align_kmeans(centers = 5L) +
  ggpanels(size = unit(1, "cm")) +
  geom_tile(aes(x = 1, fill = factor(.panel))) +
  scale_fill_brewer(palette = "Dark2", guide = "none") +
  scale_x_continuous(breaks = NULL, name = NULL) +
  (ggheatmap(mat_scaled) +
    scale_y_continuous(breaks = NULL) +
    scale_fill_viridis_c() +
    hmanno("t") +
    align_dendro() +
    ggalign(data = type, size = unit(1, "cm")) +
    geom_tile(aes(y = 1, fill = factor(value))) +
    scale_y_continuous(breaks = NULL, name = NULL) +
    scale_fill_brewer(palette = "Set1", name = "type") +
    hmanno(NULL)) +
  (ggheatmap(base_mean, width = unit(2, "cm")) +
    scale_y_continuous(breaks = NULL) +
    scale_fill_gradientn(colours = c("#2600D1FF", "white", "#EE3F3FFF")) +
    hmanno("t") +
    ggalign(size = unit(2, "cm")) +
    geom_boxplot(aes(y = value, fill = factor(.extra_panel))) +
    scale_fill_brewer(palette = "Dark2", guide = "none") +
    theme_bw()) +
  ggalign()
```

```{r}
# gset <- GEOquery::getGEO("GSE36278")
# gset <- gset[[1L]]
```

## Session information
```{r}
sessionInfo()
```
